// Comando para formatear este documento:
// npx prisma format

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id      Int      @id @default(autoincrement())
  email   String   @unique
  name    String?
  profile Profile?
}

model Profile {
  id     Int     @id @default(autoincrement())
  bio    String?
  user   User    @relation(fields: [userId], references: [id])
  userId Int     @unique
}

model Apiario {
  id             Int          @id @default(autoincrement())
  nombre         String
  fecha_creacion DateTime     @default(now())
  latitud        Float
  longitud       Float
  direccion      String
  tipo_ambiente  TipoAmbiente
  colmenas       Colmena[]
}

enum TipoAmbiente {
  RURAL
  SUBURBANO
  URBANO
}

model Colmena {
  id                          Int            @id @default(autoincrement())
  nombre                      String
  apiario                     Apiario        @relation(fields: [apiarioId], references: [id])
  apiarioId                   Int
  tipo                        TipoColmena
  datos_numero_deeps          String?
  datos_numero_supers         String?
  datos_total_cuadros         String?
  datos_color                 String?
  datos_origen                OrigenColmena?
  datos_fecha_establecimiento DateTime?      @default(now())
  reina_tipo                  TipoReina?
  reina_color                 ColorReina?
  reina_fecha_aceptacion      DateTime?
  reina_notas                 String?        @db.VarChar(200)
  foto1                       String?
  foto2                       String?
  foto3                       String?
  alertas                     Alerta[]
  Tarea                       Tarea[]
}

enum TipoColmena {
  HORIZONTAL
  LANGSTROTH
  NUCLEO
  TOPBAR
  TRADICIONAL
  TRANSICIONAL
  WARRE
}

enum OrigenColmena {
  ENJAMBRE
  NUCLEO
  SPLIT
  OBTENIDO
}

enum TipoReina {
  LOCAL
  ITALIANA
  RUSA
  CARNIOLA
  CAUCASICA
  BUCKFAST
  ARPATIANA
}

enum ColorReina {
  BLANCO
  AMARILLO
  ROJO
  VERDE
  AZUL
}

model Zona {
  id          Int          @id @default(autoincrement())
  nombre      String       @unique
  coordenadas Coordenada[]
}

model Coordenada {
  id     Int   @id @default(autoincrement())
  coord1 Float
  coord2 Float
  zona   Zona  @relation(fields: [zonaId], references: [id])
  zonaId Int
}

model Alerta {
  id          Int       @id @default(autoincrement())
  descripcion String    @db.VarChar(200)
  fecha       DateTime  @default(now())
  colmena     Colmena   @relation(fields: [colmenaId], references: [id])
  colmenaId   Int
  tipo_tarea  TipoTarea
  terminada   Boolean   @default(false)
  Tarea       Tarea[]
}

enum TipoTarea {
  TRATAMIENTO
  COSECHA
  ALIMENTACION
  CAMBIO_DE_CUADROS
}

model Tarea {
  id        Int      @id @default(autoincrement())
  fecha     DateTime @default(now())
  colmena   Colmena  @relation(fields: [colmenaId], references: [id])
  colmenaId Int
  alerta    Alerta   @relation(fields: [alertaId], references: [id])
  alertaId  Int
}
